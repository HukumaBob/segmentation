{% load i18n %}
<!DOCTYPE html>
<html lang="{% get_current_language as LANGUAGE_CODE %}{{ LANGUAGE_CODE }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% trans "Object Segmentation" %}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body.dark-mode {
            background-color: #121212;
            color: #ffffff;
        }
        .navbar.dark-mode {
            background-color: #1f1f1f;
        }
    </style>
</head>
<body class="{% if request.COOKIES.theme == 'dark' %}dark-mode{% endif %}">
    <nav id="navbar" class="navbar navbar-expand-lg {% if request.COOKIES.theme == 'dark' %}dark-mode{% else %}navbar-light bg-light{% endif %}">
      <div class="container">
        <a class="navbar-brand" href="/">{% trans "Object Segmentation" %}</a>
        <div class="collapse navbar-collapse">
          <ul class="navbar-nav me-auto">
            <li class="nav-item">
              <a class="nav-link" href="{% url 'upload_multiple_images' %}">{% trans "Upload Multiple Images" %}</a>
            </li>         
            <li class="nav-item">
              <a class="nav-link" href="{% url 'image_list' %}">{% trans "Image List" %}</a>
            </li>
          </ul>
          <form action="{% url 'set_language' %}" method="post" class="d-flex">
            {% csrf_token %}
            <select name="language" class="form-select me-2" onchange="this.form.submit()">
              <option value="en" {% if LANGUAGE_CODE == 'en' %}selected{% endif %}>English</option>
              <option value="ru" {% if LANGUAGE_CODE == 'ru' %}selected{% endif %}>Русский</option>
            </select>
          </form>
          <button id="theme-toggle" class="btn btn-outline-secondary ms-2">
            {% if request.COOKIES.theme == 'dark' %}Light Mode{% else %}Dark Mode{% endif %}
          </button>
        </div>
      </div>
    </nav>
    
    <div class="container">
      {% block content %}{% endblock %}
    </div>

    <script>
        document.getElementById('theme-toggle').addEventListener('click', function() {
            const body = document.body;
            const navbar = document.getElementById('navbar');
            const currentTheme = body.classList.toggle('dark-mode') ? 'dark' : 'light';
            document.cookie = `theme=${currentTheme}; path=/;`;
            this.textContent = currentTheme === 'dark' ? 'Light Mode' : 'Dark Mode';
            if (currentTheme === 'dark') {
                navbar.classList.add('dark-mode');
                navbar.classList.remove('navbar-light', 'bg-light');
            } else {
                navbar.classList.remove('dark-mode');
                navbar.classList.add('navbar-light', 'bg-light');
            }
        });
    </script>
</body>
</html>
